<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GETHOME — Reimagined Prototype</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg-1: #071226; /* deep navy */
    --bg-2: #08182a; /* slightly lighter */
    --glass: rgba(255,255,255,0.06);
    --glass-2: rgba(255,255,255,0.03);
    --muted: #a9c7d6;
    --accent: #7afcff;
    --accent-2: #ff85c1;
    --card: rgba(255,255,255,0.03);
    --glass-blur: 10px;
    --radius: 14px;
    --glow: 0 6px 30px rgba(122,252,255,0.06);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter, Poppins, system-ui;background:
    radial-gradient(1200px 400px at 10% 10%, rgba(122,252,255,0.03), transparent),
    linear-gradient(180deg,var(--bg-1),var(--bg-2)); color:#e8f8ff; -webkit-font-smoothing:antialiased;}
  header{
    position:sticky; top:0; z-index:50; display:flex; align-items:center; justify-content:space-between;
    padding:12px 22px; backdrop-filter: blur(6px); background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-bottom: 1px solid rgba(255,255,255,0.02);
  }

  .brand{display:flex; align-items:center; gap:12px}
  .logo{
    width:46px;height:46px;border-radius:12px;
    background: linear-gradient(135deg,var(--accent-2),var(--accent));
    display:flex; align-items:center; justify-content:center; color:#041018; font-weight:800;
    box-shadow: 0 8px 30px rgba(255,133,193,0.06);
    transform: translateZ(0);
  }
  nav{display:flex; gap:8px; align-items:center}
  nav a{
    color:var(--muted); text-decoration:none; padding:8px 12px; border-radius:10px; font-weight:600;
    transition: transform .2s ease, background .2s ease, color .18s;
  }
  nav a:hover{ transform: translateY(-3px) scale(1.02); color:var(--accent); background: rgba(255,255,255,0.02); }
  nav a.active{ color:var(--accent-2); background: rgba(255,255,255,0.025); box-shadow: 0 6px 20px rgba(122,252,255,0.03); }

  .actions{display:flex; gap:8px; align-items:center}
  .btn{
    background: linear-gradient(90deg,var(--accent-2),var(--accent)); border:none; color:#041018; padding:8px 12px;
    border-radius:10px; font-weight:800; cursor:pointer; transition: transform .14s, box-shadow .14s;
  }
  .btn:hover{ transform: translateY(-3px); box-shadow: 0 12px 40px rgba(122,252,255,0.08);}
  .ghost{
    background: transparent; border:1px solid rgba(255,255,255,0.04); padding:8px 12px; border-radius:10px; color:var(--muted);
    cursor:pointer; transition: transform .12s, background .12s;
  }
  .ghost:hover{ transform: translateY(-2px); background: rgba(255,255,255,0.01); color:var(--accent); }

  main.container{ max-width:1200px; margin:28px auto; padding:0 18px; }

  /* HERO */
  .hero{
    display:grid; grid-template-columns: 1fr 420px; gap:20px; align-items:stretch;
    margin-bottom:18px;
  }
  @media(max-width:980px){ .hero{ grid-template-columns: 1fr; } .hero-right{order:-1} }

  .panel{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:18px; border-radius:16px; border:1px solid rgba(255,255,255,0.025);
    box-shadow: var(--glow);
  }

  .hero-left h1{ margin:0; font-size:28px; letter-spacing:-0.4px; line-height:1.05 }
  .lead{ color:var(--muted); margin:8px 0 14px; max-width:70%; }

  /* Glass search */
  .search-wrap{ display:flex; gap:12px; align-items:center; margin-top:8px; }
  .search {
    display:flex; gap:10px; align-items:center; flex:1;
    padding:10px; border-radius:12px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.015));
    backdrop-filter: blur(var(--glass-blur)); border:1px solid rgba(255,255,255,0.04);
    transition: box-shadow .18s ease, transform .12s ease;
  }
  .search:focus-within{ box-shadow: 0 8px 40px rgba(122,252,255,0.04); transform: translateY(-2px); }
  .search input{
    flex:1; background:transparent; border:none; outline:none; color:#eaf6ff; font-size:14px; padding:6px 0;
  }
  .search select{ background:transparent; border:none; color:var(--muted); font-weight:600; }

  /* hero-right: 3d panel */
  .hero-right{ display:flex; flex-direction:column; gap:12px; }
  .spline-canvas{
    height:260px; border-radius:12px; overflow:hidden; position:relative; border:1px solid rgba(255,255,255,0.03);
    background: linear-gradient(180deg, rgba(10,18,28,0.6), rgba(2,6,12,0.4));
    display:flex; align-items:center; justify-content:center;
  }

  /* Placeholder '3D blob' */
  .blob {
    width:290px; height:210px; border-radius:30% 70% 60% 40% / 50% 40% 60% 50%;
    background: radial-gradient(circle at 30% 20%, rgba(255,133,193,0.12), transparent 20%),
                radial-gradient(circle at 80% 80%, rgba(122,252,255,0.08), transparent 18%),
                linear-gradient(135deg, rgba(255,133,193,0.16), rgba(122,252,255,0.10));
    filter: blur(0.6px) saturate(110%); transform-origin:center;
    transition: transform .45s cubic-bezier(.2,.9,.25,1), box-shadow .45s;
    box-shadow: 0 30px 70px rgba(2,6,12,0.6);
  }
  .blob:hover{ transform: translateY(-8px) rotateZ(3deg) scale(1.03); box-shadow: 0 40px 90px rgba(122,252,255,0.05); }

  /* Product grid */
  .product-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:16px; margin-top:18px; }
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
    border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:10px; border:1px solid rgba(255,255,255,0.02);
    transition: transform .28s cubic-bezier(.2,.9,.25,1), box-shadow .28s;
  }
  .card:hover{ transform: translateY(-8px); box-shadow: 0 25px 60px rgba(2,8,18,0.6); }
  .product-img{ height:150px; border-radius:10px; background-size:cover; background-position:center; }
  .title{ font-weight:700; color:#eaf6ff; font-size:15px }
  .price{ font-weight:800; color:var(--accent); }

  .row{ display:flex; justify-content:space-between; align-items:center; gap:8px }
  .card .actions{ display:flex; gap:8px; justify-content:flex-end; }

  /* Table-like sections */
  table{ width:100%; border-collapse:collapse; margin-top:12px; }
  th, td{ padding:10px; color:var(--muted); border-bottom:1px dashed rgba(255,255,255,0.03); text-align:left; }
  th{ color:#bfefff; font-weight:700 }

  /* modal auth */
  .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:240; }
  .modal.open{ display:flex; }
  .auth-panel{ width:920px; max-width:95%; background: linear-gradient(180deg,#071b2b,#041322); padding:14px; border-radius:12px; display:flex; gap:12px; color:#eaf6ff; }
  @media(max-width:880px){ .auth-panel{ flex-direction:column } }

  /* small interactive touches */
  .badge{ display:inline-block; background: rgba(255,255,255,0.02); padding:6px 8px; border-radius:8px; color:var(--muted); font-weight:700; }
  .stagger { opacity:0; transform: translateY(10px); transition: opacity .6s ease, transform .6s cubic-bezier(.2,.9,.25,1); }
  .stagger.visible{ opacity:1; transform:none; }

  /* Hover reveal for nav burger on mobile */
  .mobile-badge{ display:none; }
  @media(max-width:900px){ nav{display:none} .mobile-badge{display:inline-flex} }

  footer{ text-align:center; color:var(--muted); margin:28px 0 80px; }

  /* tiny utility */
  .muted{ color:var(--muted) }
  .success{ color:#7fe3b1 }
  .error{ color:#ff8b8b }
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">GH</div>
    <div style="line-height:1">
      <div style="font-weight:800;color:#eaf6ff">GetHome</div>
      <div style="font-size:11px;color:var(--muted)">Reimagined</div>
    </div>
  </div>

  <nav id="main-nav" aria-label="Main navigation">
    <a href="#" data-route="home" class="active">Home</a>
    <a href="#" data-route="products">Products</a>
    <a href="#" data-route="wishlist">Wishlist</a>
    <a href="#" data-route="orders">Orders</a>
    <a href="#" data-route="reviews">Reviews</a>
    <a href="#" data-route="customer">Customer Care</a>
    <a href="#" data-route="reports">Reports</a>
    <a href="#" data-route="about">About</a>
  </nav>

  <div class="actions">
    <button class="ghost" id="open-wishlist">Wishlist (<span id="wish-count">0</span>)</button>
    <button class="ghost" id="open-orders">Orders (<span id="order-count">0</span>)</button>
    <button class="btn" id="btn-auth">Login / Register</button>
  </div>
</header>

<main class="container">

  <!-- HERO -->
  <section id="home" class="page">
    <div class="hero">
      <div class="panel hero-left">
        <h1 class="stagger">Vibrant shopping. Subtle details. Smooth interactions.</h1>
        <p class="lead stagger">A reimagined frontend prototype — glass UI, animated interactions, scroll-driven reveals and a subtle 3D presence. Everything local and editable.</p>

        <div class="search-wrap stagger">
          <div class="search" role="search" aria-label="Search products">
            <svg style="width:18px;height:18px;opacity:.9" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" style="opacity:.9"/></svg>
            <input id="search" placeholder="Search products, e.g. headphones" aria-label="Search products">
            <select id="category" title="Category">
              <option value="all">All Categories</option>
              <option value="electronics">Electronics</option>
              <option value="fashion">Fashion</option>
              <option value="home">Home</option>
            </select>
          </div>
          <select id="sort" class="badge" title="Sort">
            <option value="default">Sort: Featured</option>
            <option value="price-asc">Price — Low to High</option>
            <option value="price-desc">Price — High to Low</option>
            <option value="newest">Newest</option>
          </select>
        </div>

        <div class="product-grid" id="product-list" aria-live="polite"></div>
      </div>

      <aside class="panel hero-right">
        <div style="display:flex;justify-content:space-between;align-items:flex-start">
          <div>
            <strong>Quick Account</strong>
            <div style="color:var(--muted);margin-top:8px;font-size:13px">Sign in to sync wishlist & orders.</div>
          </div>
          <div style="text-align:right">
            <div class="badge" id="compact-count">0 items</div>
          </div>
        </div>

        <div class="spline-canvas" id="spline-target" data-spline-placeholder>
          <!-- Lightweight CSS blob that reacts to mouse & scroll -->
          <div class="blob" id="blob"></div>

          <!--
            IMPORTANT:
            If you want to embed a Spline scene, replace the blob div
            with an iframe like:

            <iframe
              src="https://my.spline.design/your-published-scene-embed-url"
              title="3D scene" frameborder="0" style="width:100%;height:100%"></iframe>

            Then remove the JS blob-transform code if you prefer the scene controls.
          -->
        </div>

        <div style="margin-top:12px; display:flex;gap:8px">
          <button class="btn" id="quick-login">Sign in</button>
          <button class="ghost" id="quick-register">Register</button>
        </div>
      </aside>
    </div>
  </section>

  <!-- PRODUCTS (full) -->
  <section id="products" class="page panel" style="display:none">
    <h2>Products</h2>
    <div id="products-grid" class="product-grid"></div>
  </section>

  <!-- WISHLIST -->
  <section id="wishlist" class="page panel" style="display:none">
    <h2>Your Wishlist</h2>
    <table id="wishlist-table"><thead><tr><th>Product</th><th>Price</th><th>Action</th></tr></thead><tbody></tbody></table>
  </section>

  <!-- ORDERS -->
  <section id="orders" class="page panel" style="display:none">
    <h2>Your Orders</h2>
    <table id="orders-table"><thead><tr><th>Order ID</th><th>Product</th><th>Qty</th><th>Price</th><th>Status</th></tr></thead><tbody></tbody></table>
  </section>

  <!-- REVIEWS -->
  <section id="reviews" class="page panel" style="display:none">
    <h2>Comments & Reviews</h2>
    <div id="reviews-list" style="display:flex;flex-direction:column;gap:10px"></div>
    <form id="review-form" style="max-width:640px;margin-top:12px">
      <input id="rev-name" placeholder="Your name" required>
      <textarea id="rev-text" rows="3" placeholder="Write your review" required></textarea>
      <button class="btn" type="submit">Post Review</button>
    </form>
  </section>

  <!-- CUSTOMER CARE -->
  <section id="customer" class="page panel" style="display:none">
    <h2>Customer Care</h2>
    <form id="cc-page-form" style="max-width:640px">
      <input id="ccp-name" placeholder="Full name" required>
      <input id="ccp-email" type="email" placeholder="Email" required>
      <select id="ccp-topic"><option>Order issue</option><option>Payment</option><option>Return</option><option>Other</option></select>
      <textarea id="ccp-desc" rows="4" placeholder="Describe your issue" required></textarea>
      <button class="btn" type="submit">Submit Ticket</button>
    </form>
    <div id="cc-page-status" style="margin-top:12px"></div>
  </section>

  <!-- REPORTS -->
  <section id="reports" class="page panel" style="display:none">
    <h2>Reports & Admin Tickets</h2>
    <form id="report-form" style="max-width:640px">
      <label for="rep-prod">Product</label>
      <select id="rep-prod"></select>
      <textarea id="rep-msg" rows="3" placeholder="Describe issue or report" required></textarea>
      <button class="ghost" type="submit">Create Report</button>
      <div id="rep-status"></div>
    </form>
    <h3 style="margin-top:14px">Report Log</h3>
    <table id="reports-table"><thead><tr><th>Report ID</th><th>Product</th><th>Details</th></tr></thead><tbody></tbody></table>
  </section>

  <section id="about" class="page panel" style="display:none">
    <h2>About this Prototype</h2>
    <p class="muted">This page is a rework of an earlier student project. It preserves all features but gives them new interaction patterns, staggered reveals, and an optional 3D element. All data is saved locally (localStorage) so you can demo it without a backend.</p>
  </section>

  <footer>Made with ♥ — interactive prototype. Local only.</footer>
</main>

<!-- AUTH Modal -->
<div id="auth-modal" class="modal" aria-hidden="true">
  <div class="auth-panel" role="dialog" aria-modal="true" aria-label="Authentication">
    <div style="flex:1">
      <div style="display:flex;gap:8px;margin-bottom:12px">
        <button class="tab active" id="auth-tab-login">Login</button>
        <button class="tab" id="auth-tab-register">Register</button>
      </div>
      <div id="login-panel">
        <form id="login-form">
          <label style="font-size:13px;margin-top:6px">Email</label>
          <input id="login-email" type="email" placeholder="you@example.com" required>
          <label style="font-size:13px;margin-top:6px">Password</label>
          <input id="login-pass" type="password" placeholder="password" required>
          <div style="display:flex;gap:8px;margin-top:10px">
            <button class="btn" type="submit">Sign In</button>
            <button class="ghost" type="button" id="login-close">Close</button>
          </div>
          <div id="login-error" style="margin-top:8px"></div>
        </form>
      </div>

      <div id="register-panel" style="display:none">
        <form id="register-form">
          <label style="font-size:13px;margin-top:6px">Full name</label>
          <input id="reg-name" placeholder="Your full name" required>
          <label style="font-size:13px;margin-top:6px">Email</label>
          <input id="reg-email" type="email" placeholder="you@example.com" required>
          <label style="font-size:13px;margin-top:6px">Password</label>
          <input id="reg-pass" type="password" placeholder="min 8 chars" required>
          <label style="font-size:13px;margin-top:6px">Confirm password</label>
          <input id="reg-pass2" type="password" placeholder="repeat password" required>
          <div style="display:flex;gap:8px;margin-top:10px">
            <button class="btn" type="submit">Create Account</button>
            <button class="ghost" type="button" id="register-close">Close</button>
          </div>
          <div id="reg-msg" style="margin-top:8px"></div>
        </form>
      </div>
    </div>

    <div style="width:320px;padding:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:10px">
      <h3 style="margin-top:0">Why create an account?</h3>
      <ul style="color:var(--muted);margin:8px 0">
        <li>Save wishlist</li>
        <li>View order history</li>
        <li>Post reviews</li>
      </ul>
      <div style="margin-top:10px">
        <strong>Signed in as:</strong>
        <div id="current-user" style="color:var(--accent);margin-top:8px">Not signed in</div>
      </div>
    </div>
  </div>
</div>

<script>
/* -------------------------
   Sample data & storage
   ------------------------- */
const SAMPLE_PRODUCTS = [
  {id:'p1',title:'Aurora Headphones',price:2499,category:'electronics',img:'https://images.unsplash.com/photo-1511367461989-f85a21fda167?auto=format&fit=crop&w=800&q=60',popularity:8,created:1680000000000},
  {id:'p2',title:'Neon Smartwatch',price:4999,category:'electronics',img:'https://images.unsplash.com/photo-1519741493384-9b4712b8b0e3?auto=format&fit=crop&w=800&q=60',popularity:9,created:1690000000000},
  {id:'p3',title:'Comfy Sneakers',price:3499,category:'fashion',img:'https://images.unsplash.com/photo-1519744792095-2f2205e87b6f?auto=format&fit=crop&w=800&q=60',popularity:7,created:1670000000000},
  {id:'p4',title:'Minimal Backpack',price:1999,category:'fashion',img:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?auto=format&fit=crop&w=800&q=60',popularity:6,created:1660000000000},
  {id:'p5',title:'Smart Lamp',price:1299,category:'home',img:'https://images.unsplash.com/photo-1517694712202-14dd9538aa97?auto=format&fit=crop&w=800&q=60',popularity:5,created:1650000000000},
  {id:'p6',title:'Artisan Mug',price:499,category:'home',img:'https://images.unsplash.com/photo-1504754524776-8f4f37790ca0?auto=format&fit=crop&w=800&q=60',popularity:4,created:1640000000000}
];

const storage = {
  get(k, fallback){
    try{ return JSON.parse(localStorage.getItem(k)) ?? fallback; } catch(e){ return fallback; }
  },
  set(k,v){ localStorage.setItem(k, JSON.stringify(v)); }
};

let USERS = storage.get('se_users', []);
let CURRENT_USER = storage.get('se_current', null);
let WISHLIST = storage.get('se_wishlist', []);
let ORDERS = storage.get('se_orders', []);
let REVIEWS = storage.get('se_reviews', []);
let REPORTS = storage.get('se_reports', []);

/* -------------------------
   DOM helpers
   ------------------------- */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
function el(tag, props={}, children=[]){ const e=document.createElement(tag); Object.assign(e,props); children.forEach(c=>e.appendChild(typeof c==='string'?document.createTextNode(c):c)); return e; }

/* -------------------------
   Render & UI wiring
   ------------------------- */
function init(){
  renderProductList(SAMPLE_PRODUCTS);
  renderProductsGrid();
  renderReports();
  renderTables();
  renderReviews();
  renderCounts();
  populateReportSelect();
  attachEvents();
  updateUserUI();
  initScrollStagger();
  initBlobInteraction();
}

/* product rendering */
function productCard(p, withActions=true){
  const card = el('div',{className:'card stagger'});
  const img = el('div',{className:'product-img'}); img.style.backgroundImage = `url(${p.img})`;
  const title = el('div',{className:'title'}, [document.createTextNode(p.title)]);
  const price = el('div',{className:'price'}, [document.createTextNode('₹'+p.price)]);
  const row = el('div',{className:'row'});
  row.appendChild(price);
  if(withActions){
    const actions = el('div',{className:'actions'});
    const buy = el('button',{className:'btn'}, [document.createTextNode('Buy now')]);
    buy.addEventListener('click', ()=>createOrder(p));
    const wish = el('button',{className:'ghost'}, [document.createTextNode('Wishlist')]);
    wish.addEventListener('click', ()=>toggleWishlist(p));
    actions.appendChild(buy); actions.appendChild(wish);
    row.appendChild(actions);
  }
  card.appendChild(img); card.appendChild(title); card.appendChild(row);
  return card;
}

function renderProductList(list){
  const elRoot = $('#product-list'); elRoot.innerHTML='';
  list.forEach(p=> elRoot.appendChild(productCard(p, true)));
  staggerReveal(); // run stagger after adding
}
function renderProductsGrid(){
  const el = $('#products-grid'); if(!el) return; el.innerHTML='';
  SAMPLE_PRODUCTS.forEach(p=> el.appendChild(productCard(p,false)));
  staggerReveal();
}

function renderTables(){
  renderWishlistTable();
  renderOrdersTable();
}
function renderWishlistTable(){
  const tb = $('#wishlist-table tbody'); if(!tb) return; tb.innerHTML='';
  WISHLIST.forEach(i=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${i.title}</td><td>₹${i.price}</td><td><button class='ghost small-remove' data-id='${i.id}'>Remove</button></td>`;
    tb.appendChild(tr);
  });
  $$('.small-remove').forEach(b=> b.addEventListener('click', e=>{
    const id = e.target.dataset.id; WISHLIST = WISHLIST.filter(x=>x.id!==id); storage.set('se_wishlist', WISHLIST); renderWishlistTable(); renderCounts();
  }));
}
function renderOrdersTable(){
  const tb = $('#orders-table tbody'); if(!tb) return; tb.innerHTML='';
  ORDERS.forEach(o=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${o.orderId}</td><td>${o.product}</td><td>${o.qty}</td><td>₹${o.price}</td><td>${o.status}</td>`;
    tb.appendChild(tr);
  });
}

function renderReviews(){
  const list = $('#reviews-list'); if(!list) return; list.innerHTML='';
  REVIEWS.slice().reverse().forEach(r=>{
    const d = document.createElement('div'); d.style.padding='10px'; d.style.borderRadius='8px'; d.style.background='rgba(255,255,255,0.02)';
    d.innerHTML = `<div style='display:flex;justify-content:space-between;align-items:center'><strong style='color:#eaf6ff'>${escapeHtml(r.name)}</strong><small style='color:var(--muted)'>${new Date(r.date).toLocaleString()}</small></div><div style='color:var(--muted);margin-top:8px'>${escapeHtml(r.text)}</div>`;
    list.appendChild(d);
  });
}

function renderReports(){
  const sel = $('#rep-prod'); if(sel){ sel.innerHTML=''; SAMPLE_PRODUCTS.forEach(p=>{ const opt=document.createElement('option'); opt.value=p.id; opt.textContent=p.title; sel.appendChild(opt); }); }
  const tb = $('#reports-table tbody'); if(!tb) return; tb.innerHTML='';
  REPORTS.forEach(r=>{
    const tr = document.createElement('tr'); tr.innerHTML = `<td>${r.id}</td><td>${r.product}</td><td>${escapeHtml(r.details)}</td>`; tb.appendChild(tr);
  });
}

function renderCounts(){
  $('#wish-count').textContent = WISHLIST.length;
  $('#order-count').textContent = ORDERS.length;
  $('#compact-count').textContent = `${WISHLIST.length} items`;
}

/* -------------------------
   Actions
   ------------------------- */
function toggleWishlist(p){ const found = WISHLIST.find(i=>i.id===p.id); if(found){ WISHLIST = WISHLIST.filter(i=>i.id!==p.id); } else { WISHLIST.push({...p,added:new Date().toISOString()}); } storage.set('se_wishlist',WISHLIST); renderWishlistTable(); renderCounts(); }
function createOrder(p){ const order = {orderId:'ORD'+Math.floor(Math.random()*90000+10000), product:p.title, qty:1, price:p.price, status:'Processing', date:new Date().toISOString()}; ORDERS.unshift(order); storage.set('se_orders',ORDERS); renderOrdersTable(); renderCounts(); alert('Order placed: '+order.orderId); }

/* -------------------------
   Auth
   ------------------------- */
function openAuth(){ $('#auth-modal').classList.add('open'); $('#auth-modal').setAttribute('aria-hidden','false'); showAuthPanel('login'); updateUserUI(); }
function closeAuth(){ $('#auth-modal').classList.remove('open'); $('#auth-modal').setAttribute('aria-hidden','true'); }
function showAuthPanel(which){
  if(which==='login'){ $('#login-panel').style.display='block'; $('#register-panel').style.display='none'; $('#auth-tab-login').classList.add('active'); $('#auth-tab-register').classList.remove('active'); }
  else { $('#login-panel').style.display='none'; $('#register-panel').style.display='block'; $('#auth-tab-login').classList.remove('active'); $('#auth-tab-register').classList.add('active'); }
}

function handleRegister(e){ e.preventDefault();
  const name=$('#reg-name').value.trim(); const email=$('#reg-email').value.trim().toLowerCase(); const pass=$('#reg-pass').value; const pass2=$('#reg-pass2').value; const msg=$('#reg-msg'); msg.textContent='';
  if(!name||!email||!pass){ msg.textContent='All fields required'; msg.className='error'; return }
  if(!validateEmail(email)){ msg.textContent='Invalid email'; msg.className='error'; return }
  if(pass.length<8){ msg.textContent='Password min 8 chars'; msg.className='error'; return }
  if(pass!==pass2){ msg.textContent='Passwords do not match'; msg.className='error'; return }
  if(USERS.find(u=>u.email===email)){ msg.textContent='Email already registered'; msg.className='error'; return }
  const user={id:'U'+Date.now(),name,email,password:pass}; USERS.push(user); storage.set('se_users',USERS); msg.textContent='Account created — sign in now'; msg.className='success'; $('#register-form').reset();
}

function handleLogin(e){ e.preventDefault();
  const email=$('#login-email').value.trim().toLowerCase(); const pass=$('#login-pass').value; const err=$('#login-error'); err.textContent='';
  const user = USERS.find(u=>u.email===email && u.password===pass);
  if(!user){ err.textContent='Invalid credentials'; err.className='error'; return }
  CURRENT_USER = {id:user.id, name:user.name, email:user.email}; storage.set('se_current',CURRENT_USER); updateUserUI(); closeAuth(); alert('Signed in as '+user.name);
}

function updateUserUI(){ $('#current-user').textContent = CURRENT_USER ? `${CURRENT_USER.name} (${CURRENT_USER.email})` : 'Not signed in'; }

/* reviews, cc, reports */
function handleReview(e){ e.preventDefault(); const name=$('#rev-name').value.trim(); const text=$('#rev-text').value.trim(); if(!name||!text) return alert('Please fill all fields'); REVIEWS.push({name,text,date:new Date().toISOString()}); storage.set('se_reviews',REVIEWS); renderReviews(); $('#review-form').reset(); }
function handleCCMini(e){ e.preventDefault(); $('#cc-mini-status').textContent=''; setTimeout(()=>{ $('#cc-mini-status').textContent='Thanks — we will contact you.'; $('#cc-mini-status').className='success'; $('#customer-care-mini')?.reset(); },700); }
function handleCCPage(e){ e.preventDefault(); $('#cc-page-status').textContent=''; setTimeout(()=>{ $('#cc-page-status').textContent='Ticket submitted — we will respond soon.'; $('#cc-page-status').className='success'; $('#cc-page-form').reset(); },700); }
function handleReport(e){ e.preventDefault(); const pid=$('#rep-prod').value; const details=$('#rep-msg').value.trim(); if(!details) return; const product=SAMPLE_PRODUCTS.find(p=>p.id===pid).title; const rep={id:'R'+Math.floor(Math.random()*90000+1000),product,details,date:new Date().toISOString()}; REPORTS.unshift(rep); storage.set('se_reports',REPORTS); renderReports(); $('#rep-status').textContent='Report created: '+rep.id; $('#report-form').reset(); }

/* search/filter/sort */
function applyFilters(){ const q=$('#search').value.trim().toLowerCase(); const cat=$('#category').value; const sort=$('#sort').value;
  let list = SAMPLE_PRODUCTS.filter(p=>(p.title.toLowerCase().includes(q) || (p.category && p.category.includes(q))));
  if(cat!=='all') list = list.filter(p=>p.category===cat);
  if(sort==='price-asc') list.sort((a,b)=>a.price-b.price);
  if(sort==='price-desc') list.sort((a,b)=>b.price-a.price);
  if(sort==='newest') list.sort((a,b)=>b.created-b.created);
  renderProductList(list);
}

/* nav & events */
function attachEvents(){
  $$('#main-nav a').forEach(a=>a.addEventListener('click', e=>{ e.preventDefault(); $$('#main-nav a').forEach(x=>x.classList.remove('active')); a.classList.add('active'); const route=a.dataset.route; showPage(route); }));
  $('#btn-auth').addEventListener('click', openAuth);
  $('#login-close').addEventListener('click', closeAuth);
  $('#register-close').addEventListener('click', closeAuth);
  $('#auth-tab-login').addEventListener('click', ()=>showAuthPanel('login'));
  $('#auth-tab-register').addEventListener('click', ()=>showAuthPanel('register'));
  $('#register-form').addEventListener('submit', handleRegister);
  $('#login-form').addEventListener('submit', handleLogin);
  $('#review-form').addEventListener('submit', handleReview);
  $('#cc-page-form').addEventListener('submit', handleCCPage);
  $('#report-form').addEventListener('submit', handleReport);
  $('#search').addEventListener('input', applyFilters);
  $('#category').addEventListener('change', applyFilters);
  $('#sort').addEventListener('change', applyFilters);
  $('#quick-login').addEventListener('click', ()=>{ openAuth(); showAuthPanel('login'); });
  $('#quick-register').addEventListener('click', ()=>{ openAuth(); showAuthPanel('register'); });

  $('#open-wishlist').addEventListener('click', ()=>{ showPage('wishlist'); highlightNav('wishlist'); scrollToTop(); });
  $('#open-orders').addEventListener('click', ()=>{ showPage('orders'); highlightNav('orders'); scrollToTop(); });

  // save before unload
  window.addEventListener('beforeunload', ()=>{ storage.set('se_users',USERS); storage.set('se_current',CURRENT_USER); storage.set('se_wishlist',WISHLIST); storage.set('se_orders',ORDERS); storage.set('se_reviews',REVIEWS); storage.set('se_reports',REPORTS); });
}

function showPage(id){
  $$('.page').forEach(p=>p.style.display='none');
  const el = document.getElementById(id);
  if(el) el.style.display = (id==='home') ? 'block' : 'block';
  // render dynamic bits per page
  if(id==='products') renderProductsGrid();
  if(id==='reviews') renderReviews();
  if(id==='reports') renderReports();
  if(id==='wishlist') renderWishlistTable();
  if(id==='orders') renderOrdersTable();
}
function highlightNav(route){
  $$('#main-nav a').forEach(a=>a.classList.toggle('active', a.dataset.route===route));
}
function scrollToTop(){ window.scrollTo({top:0,behavior:'smooth'}); }

function validateEmail(e){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e); }
function escapeHtml(s){ return String(s).replace(/[&<>\"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;'}[c]||c)); }

/* -------------------------
   Staggered scroll reveal
   ------------------------- */
function initScrollStagger(){
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(en=>{
      if(en.isIntersecting){
        en.target.classList.add('visible');
        // optional: add a slight delay per-child if container
        io.unobserve(en.target);
      }
    });
  }, {threshold: 0.12});
  // observe elements with .stagger
  $$('.stagger').forEach((s, i)=> {
    // progressive delay
    s.style.transitionDelay = (i*70)+'ms';
    io.observe(s);
  });
}
function staggerReveal(){
  // used after dynamic inserts
  $$('.stagger').forEach((s,i)=>{ s.classList.remove('visible'); s.style.transitionDelay = (i*60)+'ms'; });
  // small timeout to ensure engine picks up
  setTimeout(()=> initScrollStagger(), 50);
}

/* -------------------------
   Blob & 3D interaction
   - reacts to scroll and pointer for a 3D feel
   ------------------------- */
function initBlobInteraction(){
  const blob = document.getElementById('blob');
  if(!blob) return;

  // pointer parallax
  document.getElementById('spline-target').addEventListener('mousemove', (e)=>{
    const r = e.currentTarget.getBoundingClientRect();
    const px = (e.clientX - r.left) / r.width - 0.5;
    const py = (e.clientY - r.top) / r.height - 0.5;
    blob.style.transform = `translate3d(${px*18}px, ${py*-12}px, 0) rotateX(${py*6}deg) rotateY(${px*10}deg) scale(1.02)`;
  });
  document.getElementById('spline-target').addEventListener('mouseleave', ()=>{ blob.style.transform='translate3d(0,0,0) rotateX(0) rotateY(0) scale(1)'; });

  // scroll-driven subtle transform
  window.addEventListener('scroll', ()=>{
    const rect = document.getElementById('spline-target').getBoundingClientRect();
    const winH = window.innerHeight;
    const pct = Math.max(0, Math.min(1, 1 - (rect.top / winH)));
    // blob scales & rotates as it scrolls into view
    blob.style.filter = `saturate(${0.9 + pct*0.4}) blur(${Math.max(0, 1 - pct*0.8)}px)`;
    blob.style.boxShadow = `0 ${20 + pct*40}px ${60 + pct*60}px rgba(2,6,12,${0.55 - pct*0.2})`;
  });
}

/* -------------------------
   Utility: populate select
   ------------------------- */
function populateReportSelect(){ const sel = $('#rep-prod'); if(!sel) return; sel.innerHTML=''; SAMPLE_PRODUCTS.forEach(p=>{ const opt=document.createElement('option'); opt.value=p.id; opt.textContent=p.title; sel.appendChild(opt); }); }

/* -------------------------
   Initialize on DOM ready
   ------------------------- */
document.addEventListener('DOMContentLoaded', init);

/* -------------------------
   Helper: small accessibility & keyboard
   ------------------------- */
document.addEventListener('keydown', (e)=>{
  if(e.key==='Escape'){ closeAuth(); }
});
</script>
</body>
</html>
